Use master; 

GO
	CREATE DATABASE TIENDA ONLINE; 

GO 
	USE TIENDA ONLINE 

CREATE TABLE PERSONA 
(
	USUARIO VARCHAR(25) NOT NULL, 
	CONTRASEÑA VARCHARCHAR(25) NOT NULL, 
	NOMBRE VARCHAR(25) NOT NULL, 
	APELLIDO VARCHAR(25) NOT NULL, 
	DIRECCION VARCHAR(25) NOT NULL, 
	EMAIL VARCHAR(25) NOT NULL, 
	TELEFONO NUMERIC(19,0) NOT NULL, 
	CELULAR	NUMERIC(19,0) NOT NULL,
	ID_ESTADO_PERSONA BIT NOT NULL
)

CREATE TABLE ADMINISTRADOR
(
	USUARIO VARCHAR(25) NOT NULL,
	CEDULA_ADMI NUMERIC(19,0) NOT NULL
	CARGO VARCHAR(25) NOT NULL,
	ID_GENERO_ADMI BIT NOT NULL 
)

CREATE TABLE VENDEDOR
(
	USUARIO VARCHAR(25) NOT NULL,
	CEDULA_VENDEDOR NUMERIC(19,0) NOT NULL
	ZONA_VENDEDOR BIT NOT NULL,
	SEXO CHAR(6) NOT NULL, 
	ID_GENERO_VENDEDOR BIT NOT NULL 
)

CREATE TABLE GENERO 
(
	ID_GENERO BIT NOT NULL, 
	DESCRIPCION_GENERO VARCHAR(25) NOT NULL
)

CREATE TABLE ZONA 
(
	ID_ZONA BIT NOT NULL, 
	DESCRIPCION_ZONA VARCHAR(25) NOT NULL
)

CREATE TABLE CLIENTE
(
	USUARIO VARCHAR(25) NOT NULL,
	NIT  NUMERIC(19,0) NOT NULL,
	ADMINISTRADOR NUMERIC (19,0) NOT NULL
)

CREATE TABLE ADMINISTRADOR_CLIENTE
(
	CEDULA_CLIENTE NUMERIC(19,0) NOT NULL,
	NOMBRE_CLIENTE VARCHAR(25) NOT NULL
)

CREATE TABLE ESTADO 
(
	ID_ESTADO BIT NOT NULL, 
	DESCRIPCION VARCHAR(25) NOT NULL
)

CREATE TABLE PEDIDO
(
	N_PEDIDO VARCHAR(10) NOT NULL, 
	CLIENTE_NIT NUMERIC(19,0) NOT NULL
)

CREATE TABLE PEDIDO_PRODUCTO
(
	NUMERO_PEDIDO VARCHAR(10) NOT NULL,
	COD_PRODUCTO VARCHAR(10) NOT NULL, 
	CANT_PRODUCTO NUMERIC(19,0) NOT NULL,
	FECHA DATE NOT NULL
)

CREATE TABLE FACTURA_VENTA
(
	COD_FACTURA NUMERIC(19,0) NOT NULL,
	FECHA DATE NOT NULL, 
	N_PEDIDO VARCHAR(10) NOT NULL,
	ID_ESTADO_FAC BIT NOT NULL, 
	ID_PAGO NUMERIC(19,0) NOT NULL
)

CREATE TABLE ESTADO_FACTURA
(
	ID_ESTADO_FAC BIT NOT NULL, 
	DESCRIPCION_ESTADO VARCHAR(25) NOT NULL
)

CREATE TABLE FORMA_DE_PAGO
(
	ID_PAGO NUMERIC(19,0) NOT NULL
)

CREATE TABLE PRODUCTO
(
	CODIGO_PRODUCTO VARCHAR(10) NOT NULL, 
	NOMBRE_PRODUCTO VARCHAR(25) NOT NULL,
	MARCA VARCHAR(25) NOT NULL, 
	PRECIO REAL(10) NOT NULL, 
	CARACTERISTICAS VARCHAR(255) NOT NULL, 
	IVA REAL(10) NOT NULL,
	ID_CATEGORIA_PROD VARCHAR(10)
)

CREATE TABLE CATEGORIA 
(
	ID_CATEGORIA VARCHAR(10) NOT NULL, 
	DESCRIPCION_CATEGORIA VARCHAR(25) NOT NULL
)

CREATE TABLE PRODUCTO_FACTURA_COMPRA 
(
	CODIGO_PRODUCTO_FAC VARCHAR(10) NOT NULL, 
	N_FACTURA NUMERIC(19,0) NOT NULL,
	CANT_P NUMERIC(19,0) NOT NULL, 
	PNETO REAL(10) NOT NULL, 
	IVA_COMPRA REAL(10) NOT NULL, 
	TOTAL_COMPRA REAL(10) NOT NULL
)

CREATE TABLE FACTURA_COMPRA 
(
	N_FACTURA NUMERIC(19,0) NOT NULL,
	FECHA DATE NOT NULL, 
	FAC_NIT_PROVEEDOR NUMERIC(19,0) NOT NULL, 
)

CREATE TABLE PROVEEDOR 
(
	NIT_PROVEEDOR NUMERIC(19,0) NOT NULL,
	NOMBRE_PROVEEDOR VARCHAR(25) NOT NULL, 
	TEL_PROVEEDOR NUMERIC(19,0) NOT NULL, 
	CEL_PROVEEDOR NUMERIC(19,0) NOT NULL, 
	EMAIL_PROVEEDOR VARCHAR(25) NOT NULL, 
	DIRECCION_PROVEEDOR VARCHAR(25) NOT NULL
)


ALTER TABLE PERSONA
ADD PRIMARY KEY NONCLUSTERED (USUARIO)

ALTER TABLE ADMINISTRADOR
ADD PRIMARY KEY NONCLUSTERED (USUARIO)

ALTER TABLE VENDEDOR
ADD PRIMARY KEY NONCLUSTERED (USUARIO)

ALTER TABLE CLIENTE
ADD PRIMARY KEY NONCLUSTERED (USUARIO)

ALTER TABLE ESTADO
ADD PRIMARY KEY NONCLUSTERED (ID_EST)

ALTER TABLE ADMINISTRADOR_CLIENTE
ADD PRIMARY KEY NONCLUSTERED (CEDULA_CLIENTE)

ALTER TABLE GENERO
ADD PRIMARY KEY NONCLUSTERED (ID_GENERO)

ALTER TABLE ZONA
ADD PRIMARY KEY NONCLUSTERED (ID_ZONA)

ALTER TABLE PEDIDO
ADD PRIMARY KEY NONCLUSTERED (N_PEDIDO)

ALTER TABLE ESTADO_FACTURA
ADD PRIMARY KEY NONCLUSTERED (ID_ESTADO_FAC)

ALTER TABLE FORMA DE PAGO
ADD PRIMARY KEY NONCLUSTERED (ID_PAGO)

ALTER TABLE PEDIDO_PRODUCTO
ADD PRIMARY KEY NONCLUSTERED (N_PEDIDO)

ALTER TABLE PEDIDO_PRODUCTO
ADD PRIMARY KEY NONCLUSTERED (CODIGO_PRODUCTO)

ALTER TABLE FACTURA VENTA
ADD PRIMARY KEY NONCLUSTERED (COD_FACTURA)

ALTER TABLE PRODUCTO
ADD PRIMARY KEY NONCLUSTERED (CODIGO_PRODUCTO)

ALTER TABLE CATEGORIA
ADD PRIMARY KEY NONCLUSTERED (ID_CATEGORIA)

ALTER TABLE PROVEEDOR
ADD PRIMARY KEY NONCLUSTERED (NIT_PROVEEDOR)

ALTER TABLE PRODUCTO_FACTURA_COMPRA
ADD PRIMARY KEY NONCLUSTERED (CODIGO_PRODUCTO_FAC)

ALTER TABLE PRODUCTO_FACTURA_COMPRA
ADD PRIMARY KEY NONCLUSTERED (N_FACTURA)

ALTER TABLE FACTURA_COMPRA
ADD PRIMARY KEY NONCLUSTERED (N_FACTURA)

-- LLAVES FORANEAS---

ALTER TABLE PERSONA
ADD FOREIGN KEY (ID_ESTADO) REFERENCES ESTADO

ALTER TABLE CLIENTE
ADD FOREIGN KEY (USUARIO) REFERENCES PERSONA
ALTER TABLE CLIENTE
ADD FOREIGN KEY (CEDULA_CLIENTE) REFERENCES ADMINISTRADOR_CLIENTE

ALTER TABLE VENDEDOR
ADD FOREIGN KEY (USUARIO) REFERENCES PERSONA
ALTER TABLE VENDEDOR
ADD FOREIGN KEY (ID_GENERO) REFERENCES GENERO
ALTER TABLE VENDEDOR
ADD FOREIGN KEY (ID_ZONA) REFERENCES ZONA

ALTER TABLE ADMINISTRADOR
ADD FOREIGN KEY (USUARIO) REFERENCES PERSONA
ALTER TABLE ADMINISTRADOR
ADD FOREIGN KEY (ID_GENERO) REFERENCES GENERO

ALTER TABLE PEDIDO
ADD FOREIGN KEY (NIT) REFERENCES CLIENTE

ALTER TABLE PEDIDO_PRODUCTO
ADD FOREIGN KEY (N_PEDIDO) REFERENCES PEDIDO
ALTER TABLE PEDIDO_PRODUCTO
ADD FOREIGN KEY (CODIGO_PRODUCTO) REFERENCES PRODUCTO

ALTER TABLE FACTURA_VENTA
ADD FOREIGN KEY (N_PEDIDO) REFERENCES PEDIDO
ALTER TABLE FACTURA_VENTA
ADD FOREIGN KEY (ID_ESTADO_FAC) REFERENCES ESTADO_FACTURA
ALTER TABLE FACTURA_VENTA
ADD FOREIGN KEY (ID_PAGO) REFERENCES FORMA_DE_PAGO

ALTER TABLE PRODUCTO
ADD FOREIGN KEY (ID_CATEGORIA) REFERENCES CATEGORIA

ALTER TABLE PRODUCTO_FACTURA_COMPRA
ADD FOREIGN KEY (CODIGO_PRODUCTO) REFERENCES PRODUCTO
ALTER TABLE PRODUCTO_FACTURA_COMPRA
ADD FOREIGN KEY (N_FACTURA) REFERENCES FACTURA_COMPRA

ALTER TABLE FACTURA_COMPRA
ADD FOREIGN KEY (NIT_PROVEEDOR) REFERENCES PROVEEDOR




ALTER TABLE ESTADO 
ADD CONSTRAINT CHKCOD_ESTADO
CHECK (ID_ESTADO IN ('ACTIVO', 'INACTIVO'))

INSERT INTO ESTADO (ID_EST, DESCRIPCION) 
VALUES ('1', 'ACTIVO')
INSERT INTO ESTADO (ID_EST, DESCRIPCION) 
VALUES ('0', 'INACTIVO')








